# Gear pair

# Prepare a document
XNewDoc D
box b 1 1 1
box bb 2 0 0 1 1 1
XAddShape D b
XAddShape D bb
set mech [XAddMechanism D]
set link1 [XAddLink D $mech 0:1:1:1]
set link2 [XAddLink D $mech 0:1:1:2]
set joint [XAddJoint D $mech $link1 $link2]

# Start testing
XSetPairName D $joint gear
set name [XGetPairName D $joint]
if {$name != "gear"} {
  puts "Error: wrong parameter"
}
XSetPairType D $joint 13
set type [XGetPairType D $joint]
if {$type != "13"} {
  puts "Error: wrong parameter"
}

plane p1 0 0 0 0 0 1
plane p2 0 0 0 0 0 1
XSetPairTransformation D $joint 1 p1
XSetPairTransformation D $joint 2 p2
set dump_in [dump p1]
XGetPairTransformation D $joint 1 p1
set dump_out [dump p1]
if {$dump_in != $dump_out} {
  puts "Error: wrong parameter"
}
set dump_in [dump p2]
XGetPairTransformation D $joint 2 p2
set dump_out [dump p2]
if {$dump_in != $dump_out} {
  puts "Error: wrong parameter"
}

XSetPairLimits D $joint 15 30
set limits [XGetPairLimits D $joint]
if {$limits != "15 30 "} {
  puts "Error: wrong parameter"
}

XSetPairParams D $joint 1 2 3 4 5
set param [XGetPairParams D $joint]
if {$param != "First Link Radius = 1\nSecond Link Radius = 2\nBevel = 3\nHelical Angle = 4\nGear Ratio = 5"} {
  puts "Error: wrong parameter"
}

XSetPairValues D $joint -rotation 24
set values [XGetPairValues D $joint -rotation]
if {$values != "24"} {
  puts "Error: wrong parameter"
}

Close D
