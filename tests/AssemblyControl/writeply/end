# Main script in this test grid; does all the job.
# Individual test scripts are used only to specify data file and reference
# test data (expected values of test execution).
# The procedure is:
# - load specified data files
# - check validity of result shape, vizualize building compartments, 
# and regenerate reference results if dump flag set to 1 

# Set flag dump_file to 1 in order to regenerate  results
# used as reference. In this mode all tests intentionaly report failure.
set dump_file 0
puts $gridname
set distval 0
set densval 0.1
########################################################################
set curfile $filename.brep 
restore $curfile a
set pathname Results-dist-$distval-dens-$densval
file mkdir $pathname
set sh [explode a ]
set nbsh [llength $sh]
puts $nbsh
 if {$nbsh > 1} {
    puts "Error: Number of subhapes: $nbsh"
    writepointclouds_ply $pathname/$filename.ply a -dist $distval -dens $densval
} else {
LocDump a_1
LocSet a_1 
LocDump a_1
writepointclouds_ply $pathname/$filename.ply a_1 -dist $distval -dens $densval
}
#vdump $imagedir/$filename.png
#set to initial path
cd ../..
puts "TEST COMPLETED"