puts "============"
puts "OCC28091"
puts "============"
puts ""
######################################################
# Crash in Boolean operation in OCCT 6.7.0 version
######################################################

plane pl11 18.00373091680785400000 142.00002092741130000000 -2190.47435610915950000000 -0.00000000000000034348 -0.00000000000000060120 1.00000000000000000000 0.00000000000000000000 -1.00000000000000000000 -0.00000000000000060120
pcylinder cyl11 pl11 3.24989999999999980000 2190.47435610915950000000

plane pl12 18.00373091680709700000 142.00002092740999000000 6.00000000000000000000 -0.00000000000000034348 -0.00000000000000060120 1.00000000000000000000 0.00000000000000000000 -1.00000000000000000000 -0.00000000000000060120
pcylinder cyl12 pl12 3.24989999999999980000 2190.47435610915950000000

plane pl21 18.00373091680745600000 735.33335426074439000000 -2190.47435610915860000000 -0.00000000000000034348 -0.00000000000000060120 1.00000000000000000000 0.00000000000000000000 -1.00000000000000000000 -0.00000000000000060120
pcylinder cyl21 pl21 3.24989999999999980000 2190.47435610915950000000

plane pl22 18.00373091680669900000 735.33335426074302000000 6.00000000000099480000 -0.00000000000000034348 -0.00000000000000060120 1.00000000000000000000 0.00000000000000000000 -1.00000000000000000000 -0.00000000000000060120
pcylinder cyl22 pl22 3.24989999999999980000 2190.47435610915950000000

plane pl31 18.00373091680695100000 1328.66668759407640000000 -2190.47435610915860000000 -0.00000000000000034348 -0.00000000000000060120 1.00000000000000000000 0.00000000000000000000 -1.00000000000000000000 -0.00000000000000060120
pcylinder cyl31 pl31 3.24989999999999980000 2190.47435610915950000000

plane pl32 18.00373091680619500000 1328.66668759407500000000 6.00000000000099480000 -0.00000000000000034348 -0.00000000000000060120 1.00000000000000000000 0.00000000000000000000 -1.00000000000000000000 -0.00000000000000060120
pcylinder cyl32 pl32 3.24989999999999980000 2190.47435610915950000000

plane pl41 18.00373091680645400000 1922.00002092740940000000 -2190.47435610915770000000 -0.00000000000000034348 -0.00000000000000060120 1.00000000000000000000 0.00000000000000000000 -1.00000000000000000000 -0.00000000000000060120
pcylinder cyl41 pl41 3.24989999999999980000 2190.47435610915950000000

plane pl42 18.00373091680569700000 1922.00002092740810000000 6.00000000000198950000 -0.00000000000000034348 -0.00000000000000060120 1.00000000000000000000 0.00000000000000000000 -1.00000000000000000000 -0.00000000000000060120
pcylinder cyl42 pl42 3.24989999999999980000 2190.47435610915950000000

plane pl51 632.00373126567490000000 735.33335426074439000000 -2190.47435610915860000000 -0.00000000000000034348 -0.00000000000000060120 1.00000000000000000000 0.00000000000000000000 -1.00000000000000000000 -0.00000000000000060120
pcylinder cyl51 pl51 3.24989999999999980000 2190.47435610915950000000

plane pl52 632.00373126567411000000 735.33335426074302000000 6.00000000000099480000 -0.00000000000000034348 -0.00000000000000060120 1.00000000000000000000 0.00000000000000000000 -1.00000000000000000000 -0.00000000000000060120
pcylinder cyl52 pl52 3.24989999999999980000 2190.47435610915950000000

plane pl61 632.00373126567490000000 1328.66668759407730000000 -2190.47435610915860000000 -0.00000000000000034348 -0.00000000000000060120 1.00000000000000000000 0.00000000000000000000 -1.00000000000000000000 -0.00000000000000060120
pcylinder cyl61 pl61 3.24989999999999980000 2190.47435610915950000000

plane pl62 632.00373126567411000000 1328.66668759407590000000 6.00000000000099480000 -0.00000000000000034348 -0.00000000000000060120 1.00000000000000000000 0.00000000000000000000 -1.00000000000000000000 -0.00000000000000060120
pcylinder cyl62 pl62 3.24989999999999980000 2190.47435610915950000000

plane pl71 549.09715848122084000000 142.00002092739834000000 -2190.47435610915860000000 -0.00000000000000034348 -0.00000000000000060120 1.00000000000000000000 0.00000000000000000000 -1.00000000000000000000 -0.00000000000000060120
pcylinder cyl71 pl71 3.24989999999999980000 2190.47435610915950000000

plane pl72 549.09715848122005000000 142.00002092739703000000 6.00000000000099480000 -0.00000000000000034348 -0.00000000000000060120 1.00000000000000000000 0.00000000000000000000 -1.00000000000000000000 -0.00000000000000060120
pcylinder cyl72 pl72 3.24989999999999980000 2190.47435610915950000000

plane pl81 549.09715848122084000000 1922.00002092742240000000 -2190.47435610915770000000 -0.00000000000000034348 -0.00000000000000060120 1.00000000000000000000 0.00000000000000000000 -1.00000000000000000000 -0.00000000000000060120
pcylinder cyl81 pl81 3.24989999999999980000 2190.47435610915950000000

plane pl82 549.09715848122005000000 1922.00002092742100000000 6.00000000000201790000 -0.00000000000000034348 -0.00000000000000060120 1.00000000000000000000 0.00000000000000000000 -1.00000000000000000000 -0.00000000000000060120
pcylinder cyl82 pl82 3.24989999999999980000 2190.47435610915950000000


binrestore [locate_data_file bug28091_RB11_PG_00441_02.brep] sh

compound CmpdSrcFList

foreach ff [ explode sh f ] {
  settolerance $ff 1.0e-7
  fixshape rf $ff
  add rf CmpdSrcFList
}

puts ""
puts ""

set i 0
foreach x {1 2 3 4 5 6 7 8} {
  incr i
  
  copy CmpdSrcFList sshape
  foreach cyf [explode cyl${x}1 f] {
    mksurface sf $cyf;
    if { [ string first "Cylindr" [ dump sf ] ]  >= 0 } {
      bsection r${i}1 sshape $cyf -n2d -na
      break
    }
  }
  
  copy CmpdSrcFList sshape
  foreach cyf [explode cyl${x}2 f] {
    mksurface sf $cyf;
    if { [ string first "Cylindr" [ dump sf ] ]  >= 0 } {
      bsection r${i}2 sshape $cyf -n2d -na
      break
    }
  }
}

# The true number of entities is not important.
# The main idea is to check if:
#   1. The result (r*) is empty or not.
#   2. new interfered entities are found or
#       if some interferences are not detected but was
#       detected earlier.
#
# Changes in behavior at least in one item must be considered (most likely)
# as regression.

checknbshapes r11 -vertex 0
checknbshapes r12 -vertex 0
checknbshapes r21 -vertex 0
checknbshapes r22 -vertex 0
checknbshapes r31 -vertex 0
checknbshapes r32 -vertex 0
checknbshapes r41 -vertex 0
checknbshapes r42 -vertex 0
checknbshapes r51 -vertex 0
checknbshapes r52 -vertex 0
checknbshapes r61 -vertex 0
checknbshapes r62 -vertex 0
checknbshapes r71 -vertex 0
checknbshapes r72 -vertex 0
checknbshapes r81 -vertex 0
checknbshapes r82 -vertex 0
