puts "========"
puts "OCC26310"
puts "========"
puts ""
#################################################
# Very slow boolean cut operations on cylinders
#################################################

if { [regexp {Debug mode} [dversion]] } {
    set max_time 1.0
} else {
    set max_time 0.5
}

set ExpTol1 1.3823335207427231e-006
set ExpTol2 1.818012742776421e-006

set GoodNbCurv 4

restore [locate_data_file OCC26310-b1.brep] b1 
restore [locate_data_file OCC26310-b2.brep] b2

explode b1 f
explode b2 f

dchrono cr reset
dchrono cr start
set log [bopcurves b1_1 b2_1 -2d]
dchrono cr stop
regexp {Tolerance Reached=+([-0-9.+eE]+)\n+([-0-9.+eE]+)} ${log} full Toler NbCurv

checkreal ToleranceReached ${Toler} ${ExpTol1} 0.0 0.01

if {${NbCurv} != ${GoodNbCurv}} {
  puts "Error: Number of curves is bad!"
}

set log2 [dchrono cr show]

regexp {CPU user time: ([-0-9.+eE]+) seconds} $log2 full sec

if { $sec > ${max_time} } {
    puts "Error: CPU user time is more than ${max_time} seconds"
} else {
    puts "OK: CPU user time is less than ${max_time} seconds"
}

dchrono cr reset
dchrono cr start
set log [bopcurves b2_1 b1_1 -2d]
dchrono cr stop

regexp {Tolerance Reached=+([-0-9.+eE]+)\n+([-0-9.+eE]+)} ${log} full Toler NbCurv

checkreal ToleranceReached ${Toler} ${ExpTol2} 0.0 0.01

if {${NbCurv} != ${GoodNbCurv}} {
  puts "Error: Number of curves is bad!"
}

set log2 [dchrono cr show]

regexp {CPU user time: ([-0-9.+eE]+) seconds} $log2 full sec

if { $sec > ${max_time} } {
    puts "Error: CPU user time is more than ${max_time} seconds"
} else {
    puts "OK: CPU user time is less than ${max_time} seconds"
}
