puts "TODO CR23096 ALL: DATA : Faulty" 
puts "TODO CR23096 ALL: LABELS : Faulty" 
puts "TODO CR23096 ALL: LAYERS : Faulty" 

set filename polyrepro_13juin.igs


ReadFileToDoc ${filename}

puts "Check document D_First"
puts "Compare with reference data"
checkdoc "data c" -max_warns 0 -max_faults 0
checkdoc "tpstat c" -max_warns 1168 -max_faults 181
checkxstat D_First -n0 8 -n1 3130 -n2 0 -total 3138 -withname 1918 -withcolor 3130 -withlayer 3128 -centroid 0 -volume 0 -area 0 -colors { BLUE1 CYAN1 GREEN MAGENTA1 MAGENTA3 MEDIUMPURPLE1 RED WHITE YELLOW YELLOW3 } -nbcolors 10 -layers { 100 101 102 110 111 120 121 122 123 125 126 127 128 130 131 132 133 134 135 136 137 138 140 141 142 150 20 21 254 30 31 5 50 51 52 53 } -nblayers 36

XGetOneShape res_1 D_First

puts "Check shape from document D_First"
checkshapeff res_1 -max_wires 0 -max_faces 0 -max_shells 0 -max_solids 0
checknbshapes res_1 -solid 0 -shell 0 -face 527 -shape 10203
checkstatshape res_1 -solid 0 -shell 0 -face 527 -freewire 57 -freeedge 1172 -sharededge 4009
set max_tol_res_1 [checkmaxtol res_1 -tol 0.5505691341 -avg 0.008366976269]

ReOpenDoc ${filename}

XGetOneShape res_2 D_Second

puts "Check document D_Second"
puts "Compare with document D_First"
checkdoc "data c" -max_warns 0 -max_faults 0
checkdoc "tpstat c" -max_warns 1168 -max_faults 181
puts "Compare with reference data"
checkdoc "data c" -max_warns 0 -max_faults 20
checkdoc "tpstat c" -max_warns 83 -max_faults 40

puts "Compare with doc D_First"
checkxstat D_Second -n0 8 -n1 3130 -n2 0 -total 3138 -withname 1918 -withcolor 3130 -withlayer 3128 -centroid 0 -volume 0 -area 0 -nbcolors 10 -nblayers 36

puts "Compare with reference values"
checkxstat D_Second -n0 8 -n1 1544 -n2 0 -total 1552 -withname 1552 -withcolor 1544 -withlayer 1544 -centroid 0 -volume 0 -area 0 -colors { BLUE1 CYAN1 GREEN MAGENTA1 MAGENTA3 MEDIUMPURPLE1 RED WHITE YELLOW YELLOW3  } -nbcolors 10 -layers { 100 101 102 110 111 120 121 122 123 125 126 127 128 130 131 132 133 134 135 136 137 138 140 141 142 150 20 21 254 31 5 50 51 52 53  } -nblayers 35

puts "Check shape from document D_Second"
puts "Compare with shape res_1"
checkshapeff res_2 -max_wires 0 -max_faces 0 -max_shells 0 -max_solids 0
puts "Compare with reference data"
checkshapeff res_2 -max_wires 0 -max_faces 0 -max_shells 0 -max_solids 0
set nbshapes_res_1 [nbshapes res_1]
regexp {SHAPE +: +([-0-9.+eE]+)} ${nbshapes_res_1} full shape_res_1
regexp {COMPOUND +: +([-0-9.+eE]+)} ${nbshapes_res_1} full comp_res_1
set shape_comp_res_1 [expr ${shape_res_1} - ${comp_res_1}]
checknbshapes res_2 -solid 0 -shell 0 -face 527 -shape 10204 -de_iges ${shape_comp_res_1}
checkstatshape res_2 -solid 0 -shell 0 -face 527 -freewire 57 -freeedge 1172 -sharededge 4009 -max_solid 0 -max_shell 0 -max_face 527 -max_freewire 57 -max_freeedge 1172
checkmaxtol res_2 -tol 0.5505691323 -avg 0.008350628685 -max_tol ${max_tol_res_1}

